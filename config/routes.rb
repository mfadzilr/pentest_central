Rails.application.routes.draw do
  root 'home#index'

  devise_for :users, controllers: { registrations: 'registrations' }

  as :user do
    get 'user/edit' => 'devise/registrations#edit', as: 'edit_user_registration'
    put 'users' => 'registrations#update', as: 'user_registration'
  end

  # resources :users
  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html

  resources :projects do
    member do
      get 'export'
    end

    resources :data_sources do
      resources :hosts, only: [:index]
    end

    resources :hosts do
      collection do
        get 'search'
      end
    end

    resources :findings do
      collection do
        get 'search'
      end
    end

    resources :team_members

    collection do
      post ':project_id/findings/enable/:finding_id', to: 'findings#enable', as: 'enable'
      post ':project_id/findings/disable/:finding_id', to: 'findings#disable', as: 'disable'

      post ':project_id/hosts/enable/:host_id', to: 'hosts#enable', as: 'enable_host'
      post ':project_id/hosts/disable/:host_id', to: 'hosts#disable', as: 'disable_host'
    end
  end

  resources :data_sources do
    member do
      get 'export'
    end
    resources :hosts
  end

  resources :hosts do
    member do
      get 'select_data_source'
    end

    collection do
      get 'search'
    end

    resources :findings
  end

  resources :findings do
    resources :screen_captures
    member do
      get 'copy'
      get 'select_host'
    end
    collection do
      get 'search'
    end
  end

  resources :screen_captures
  resources :team_members
end
