class Project < ApplicationRecord
  serialize :project_team_ids

  belongs_to  :user
  has_many    :data_sources, dependent: :destroy

  has_many    :project_teams, dependent: :destroy
  has_many    :team_members, through: :project_teams

  validates :name, presence: true, uniqueness: { case_sensitive: false }
  validates :client_name, presence: true
  validate :end_date_is_after_start_date

  def end_date_is_after_start_date
    return if date_end.blank? || date_start.blank?
    if date_end < date_start
      errors.add(:date_end, 'cannot be before the start date')
    end
  end

end
